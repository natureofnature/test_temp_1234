INFO 09-11 17:22:01 [__init__.py:36] Available plugins for group vllm.platform_plugins:
INFO 09-11 17:22:01 [__init__.py:38] - ascend -> vllm_ascend:register
INFO 09-11 17:22:01 [__init__.py:41] All plugins in this group will be loaded. Set `VLLM_PLUGINS` to control which plugins to load.
INFO 09-11 17:22:01 [__init__.py:232] Platform plugin ascend is activated
WARNING 09-11 17:22:02 [_custom_ops.py:20] Failed to import from vllm._C with ModuleNotFoundError("No module named 'vllm._C'")
INFO 09-11 17:22:03 [importing.py:63] Triton not installed or not compatible; certain GPU-related functions will not be available.
WARNING 09-11 17:22:03 [registry.py:477] Model architecture DeepSeekMTPModel is already registered, and will be overwritten by the new model class vllm_ascend.models.deepseek_mtp:CustomDeepSeekMTP.
WARNING 09-11 17:22:03 [registry.py:477] Model architecture Qwen2VLForConditionalGeneration is already registered, and will be overwritten by the new model class vllm_ascend.models.qwen2_vl:AscendQwen2VLForConditionalGeneration.
WARNING 09-11 17:22:03 [registry.py:477] Model architecture Qwen2_5_VLForConditionalGeneration is already registered, and will be overwritten by the new model class vllm_ascend.models.qwen2_5_vl:AscendQwen2_5_VLForConditionalGeneration.
WARNING 09-11 17:22:03 [registry.py:477] Model architecture DeepseekV2ForCausalLM is already registered, and will be overwritten by the new model class vllm_ascend.models.deepseek_v2:CustomDeepseekV2ForCausalLM.
WARNING 09-11 17:22:03 [registry.py:477] Model architecture DeepseekV3ForCausalLM is already registered, and will be overwritten by the new model class vllm_ascend.models.deepseek_v3:CustomDeepseekV3ForCausalLM.
WARNING 09-11 17:22:03 [registry.py:477] Model architecture Qwen3MoeForCausalLM is already registered, and will be overwritten by the new model class vllm_ascend.models.qwen3_moe:CustomQwen3MoeForCausalLM.
WARNING 09-11 17:22:03 [registry.py:477] Model architecture Qwen3ForCausalLM is already registered, and will be overwritten by the new model class vllm_ascend.models.qwen3:CustomQwen3ForCausalLM.
INFO 09-11 17:22:03 [utils.py:328] non-default args: {'trust_remote_code': True, 'max_model_len': 4096, 'tensor_parallel_size': 2, 'context_parallel_size': 4, 'enable_sequence_parallel': True, 'enable_expert_parallel': True, 'block_size': 128, 'enable_prefix_caching': False, 'max_num_batched_tokens': 1024, 'disable_log_stats': True, 'enforce_eager': True, 'enable_chunked_prefill': True, 'additional_config': {'ascend_scheduler_config': {'enabled': True}}, 'model': '/home/DeepSeek-V2-Lite'}
INFO 09-11 17:22:03 [config.py:234] Replacing legacy 'type' key with 'rope_type'
INFO 09-11 17:22:10 [__init__.py:744] Resolved architecture: DeepseekV2ForCausalLM
INFO 09-11 17:22:10 [__init__.py:1773] Using max model len 4096
INFO 09-11 17:22:10 [config.py:234] Replacing legacy 'type' key with 'rope_type'
INFO 09-11 17:22:10 [scheduler.py:226] Chunked prefill is enabled with max_num_batched_tokens=1024.
INFO 09-11 17:22:10 [platform.py:144] Compilation disabled, using eager mode by default
WARNING 09-11 17:22:10 [platform.py:162] compilation_config.level = CompilationLevel.NO_COMPILATION is set, Setting CUDAGraphMode to NONE
[1;36m(EngineCore_0 pid=184509)[0;0m INFO 09-11 17:22:10 [core.py:648] Waiting for init message from front-end.
[1;36m(EngineCore_0 pid=184509)[0;0m INFO 09-11 17:22:10 [core.py:75] Initializing a V1 LLM engine (v0.1.dev9077+g05579c458) with config: model='/home/DeepSeek-V2-Lite', speculative_config=None, tokenizer='/home/DeepSeek-V2-Lite', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config={}, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=4096, download_dir=None, load_format=auto, tensor_parallel_size=2, pipeline_parallel_size=1, disable_custom_all_reduce=True, quantization=None, enforce_eager=True, kv_cache_dtype=auto, device_config=npu, decoding_config=DecodingConfig(backend='auto', disable_fallback=False, disable_any_whitespace=False, disable_additional_properties=False, reasoning_backend=''), observability_config=ObservabilityConfig(show_hidden_metrics_for_version=None, otlp_traces_endpoint=None, collect_detailed_traces=None), seed=0, served_model_name=/home/DeepSeek-V2-Lite, enable_prefix_caching=False, chunked_prefill_enabled=True, use_async_output_proc=True, pooler_config=None, compilation_config={"level":0,"debug_dump_path":"","cache_dir":"","backend":"","custom_ops":["all"],"splitting_ops":null,"use_inductor":true,"compile_sizes":[],"inductor_compile_config":{"enable_auto_functionalized_v2":false},"inductor_passes":{},"cudagraph_mode":0,"use_cudagraph":true,"cudagraph_num_of_warmups":1,"cudagraph_capture_sizes":[],"cudagraph_copy_inputs":false,"full_cuda_graph":false,"pass_config":{},"max_capture_size":0,"local_cache_dir":null}
[1;36m(EngineCore_0 pid=184509)[0;0m WARNING 09-11 17:22:10 [multiproc_worker_utils.py:273] Reducing Torch parallelism from 640 threads to 1 to avoid unnecessary CPU contention. Set OMP_NUM_THREADS in the external environment to tune this value as needed.
[1;36m(EngineCore_0 pid=184509)[0;0m INFO 09-11 17:22:10 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[0, 1, 2, 3, 4, 5, 6, 7], buffer_handle=(8, 16777216, 10, 'psm_e1be5e14'), local_subscribe_addr='ipc:///tmp/ea23c1a0-a3f1-43d6-a629-520b6f05e96d', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:16 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[0], buffer_handle=(1, 10485760, 10, 'psm_d9de4f83'), local_subscribe_addr='ipc:///tmp/601075c4-c0b4-4832-a3a7-71862e67c549', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:18 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[0], buffer_handle=(1, 10485760, 10, 'psm_23e0f7c8'), local_subscribe_addr='ipc:///tmp/351c562a-6b0a-489c-8dd6-831c58ecd57e', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:18 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[0], buffer_handle=(1, 10485760, 10, 'psm_9f01ea11'), local_subscribe_addr='ipc:///tmp/6e39297a-e998-4986-92e4-f54f8059ce2c', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:20 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[0], buffer_handle=(1, 10485760, 10, 'psm_023e8d75'), local_subscribe_addr='ipc:///tmp/259f4e0d-f5e8-4731-b2d9-b8c2c75f4e78', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:20 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[0], buffer_handle=(1, 10485760, 10, 'psm_154713e6'), local_subscribe_addr='ipc:///tmp/16cc7018-59fb-4835-b419-51efaccf5593', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:20 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[0], buffer_handle=(1, 10485760, 10, 'psm_93402a9f'), local_subscribe_addr='ipc:///tmp/fe2c417d-0686-411f-8819-fd098ce880a9', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:20 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[0], buffer_handle=(1, 10485760, 10, 'psm_25cd19fc'), local_subscribe_addr='ipc:///tmp/f5f0dcf8-c9a5-4dd9-9d48-992eda8d46e3', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:20 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[0], buffer_handle=(1, 10485760, 10, 'psm_50d57d19'), local_subscribe_addr='ipc:///tmp/77546165-1bbb-4f2f-9d47-62a73cac4ac6', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:21 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[1], buffer_handle=(1, 4194304, 6, 'psm_c34307e5'), local_subscribe_addr='ipc:///tmp/305c1bd8-4ca0-4ca8-aa49-3df81d03d360', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:21 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[1], buffer_handle=(1, 4194304, 6, 'psm_9dd83352'), local_subscribe_addr='ipc:///tmp/f2b498ae-eb76-4598-9111-43dd94485f51', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:21 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[1], buffer_handle=(1, 4194304, 6, 'psm_0b4476ff'), local_subscribe_addr='ipc:///tmp/5662d861-6de3-4877-b1a6-26f7c10f644e', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:21 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[1], buffer_handle=(1, 4194304, 6, 'psm_d74e2511'), local_subscribe_addr='ipc:///tmp/b6b030aa-b92d-4ded-8d8c-03b2b776959b', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:21 [parallel_state.py:1163] rank 0 in world size 8 is assigned as DP rank 0, PP rank 0, TP rank 0, EP rank 0, CP rank 0
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:21 [parallel_state.py:1163] rank 1 in world size 8 is assigned as DP rank 0, PP rank 0, TP rank 1, EP rank 1, CP rank 0
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:21 [parallel_state.py:1163] rank 2 in world size 8 is assigned as DP rank 0, PP rank 0, TP rank 0, EP rank 2, CP rank 1
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:21 [parallel_state.py:1163] rank 4 in world size 8 is assigned as DP rank 0, PP rank 0, TP rank 0, EP rank 4, CP rank 2
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:21 [parallel_state.py:1163] rank 3 in world size 8 is assigned as DP rank 0, PP rank 0, TP rank 1, EP rank 3, CP rank 1
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:21 [parallel_state.py:1163] rank 7 in world size 8 is assigned as DP rank 0, PP rank 0, TP rank 1, EP rank 7, CP rank 3
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:21 [parallel_state.py:1163] rank 6 in world size 8 is assigned as DP rank 0, PP rank 0, TP rank 0, EP rank 6, CP rank 3
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:21 [parallel_state.py:1163] rank 5 in world size 8 is assigned as DP rank 0, PP rank 0, TP rank 1, EP rank 5, CP rank 2
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:21 [model_runner_v1.py:2585] Starting to load model /home/DeepSeek-V2-Lite...
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:21 [model_runner_v1.py:2585] Starting to load model /home/DeepSeek-V2-Lite...
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:21 [model_runner_v1.py:2585] Starting to load model /home/DeepSeek-V2-Lite...
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:21 [model_runner_v1.py:2585] Starting to load model /home/DeepSeek-V2-Lite...
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:21 [model_runner_v1.py:2585] Starting to load model /home/DeepSeek-V2-Lite...
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:21 [model_runner_v1.py:2585] Starting to load model /home/DeepSeek-V2-Lite...
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:21 [model_runner_v1.py:2585] Starting to load model /home/DeepSeek-V2-Lite...
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:21 [model_runner_v1.py:2585] Starting to load model /home/DeepSeek-V2-Lite...
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:21 [layer.py:845] [EP Rank 1/8] Expert parallelism is enabled. Local/global number of experts: 8/64. Experts local to global index map: 0->8, 1->9, 2->10, 3->11, 4->12, 5->13, 6->14, 7->15.
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:21 [layer.py:845] [EP Rank 6/8] Expert parallelism is enabled. Local/global number of experts: 8/64. Experts local to global index map: 0->48, 1->49, 2->50, 3->51, 4->52, 5->53, 6->54, 7->55.
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:21 [layer.py:845] [EP Rank 5/8] Expert parallelism is enabled. Local/global number of experts: 8/64. Experts local to global index map: 0->40, 1->41, 2->42, 3->43, 4->44, 5->45, 6->46, 7->47.
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:21 [layer.py:845] [EP Rank 3/8] Expert parallelism is enabled. Local/global number of experts: 8/64. Experts local to global index map: 0->24, 1->25, 2->26, 3->27, 4->28, 5->29, 6->30, 7->31.
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:22 [layer.py:845] [EP Rank 7/8] Expert parallelism is enabled. Local/global number of experts: 8/64. Experts local to global index map: 0->56, 1->57, 2->58, 3->59, 4->60, 5->61, 6->62, 7->63.
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:22 [layer.py:845] [EP Rank 0/8] Expert parallelism is enabled. Local/global number of experts: 8/64. Experts local to global index map: 0->0, 1->1, 2->2, 3->3, 4->4, 5->5, 6->6, 7->7.
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:22 [layer.py:845] [EP Rank 2/8] Expert parallelism is enabled. Local/global number of experts: 8/64. Experts local to global index map: 0->16, 1->17, 2->18, 3->19, 4->20, 5->21, 6->22, 7->23.
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:22 [layer.py:845] [EP Rank 4/8] Expert parallelism is enabled. Local/global number of experts: 8/64. Experts local to global index map: 0->32, 1->33, 2->34, 3->35, 4->36, 5->37, 6->38, 7->39.
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:25 [default_loader.py:267] Loading weights took 2.29 seconds
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:25 [default_loader.py:267] Loading weights took 2.16 seconds
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:25 [default_loader.py:267] Loading weights took 2.32 seconds
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:25 [default_loader.py:267] Loading weights took 2.33 seconds
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:25 [default_loader.py:267] Loading weights took 2.39 seconds
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:25 [default_loader.py:267] Loading weights took 2.40 seconds
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:25 [default_loader.py:267] Loading weights took 2.44 seconds
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:25 [default_loader.py:267] Loading weights took 2.46 seconds
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:25 [model_runner_v1.py:2615] Loading model weights took 5.3622 GB
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:26 [model_runner_v1.py:2615] Loading model weights took 5.3622 GB
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:26 [model_runner_v1.py:2615] Loading model weights took 5.3622 GB
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:26 [model_runner_v1.py:2615] Loading model weights took 5.3622 GB
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:26 [model_runner_v1.py:2615] Loading model weights took 5.3622 GB
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:26 [model_runner_v1.py:2615] Loading model weights took 5.3622 GB
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:26 [model_runner_v1.py:2615] Loading model weights took 5.3622 GB
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:26 [model_runner_v1.py:2615] Loading model weights took 5.3622 GB
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:30 [worker_v1.py:190] Available memory: 51927407411, total memory: 65796046848
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:30 [worker_v1.py:190] Available memory: 51937189683, total memory: 65796046848
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:30 [worker_v1.py:190] Available memory: 51701788672, total memory: 65787658240
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:31 [worker_v1.py:190] Available memory: 51936969523, total memory: 65796046848
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:31 [worker_v1.py:190] Available memory: 51215794176, total memory: 65787658240
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:31 [worker_v1.py:190] Available memory: 51689830400, total memory: 65787658240
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:31 [worker_v1.py:190] Available memory: 51925748531, total memory: 65796046848
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:31 [worker_v1.py:190] Available memory: 51700935680, total memory: 65787658240
[1;36m(EngineCore_0 pid=184509)[0;0m INFO 09-11 17:22:31 [kv_cache_utils.py:850] GPU KV cache size: 1,646,592 tokens
[1;36m(EngineCore_0 pid=184509)[0;0m INFO 09-11 17:22:31 [kv_cache_utils.py:854] Maximum concurrency for 4,096 tokens per request: 3216.00x
[1;36m(EngineCore_0 pid=184509)[0;0m INFO 09-11 17:22:31 [kv_cache_utils.py:850] GPU KV cache size: 1,669,760 tokens
[1;36m(EngineCore_0 pid=184509)[0;0m INFO 09-11 17:22:31 [kv_cache_utils.py:854] Maximum concurrency for 4,096 tokens per request: 3261.25x
[1;36m(EngineCore_0 pid=184509)[0;0m INFO 09-11 17:22:31 [kv_cache_utils.py:850] GPU KV cache size: 1,662,208 tokens
[1;36m(EngineCore_0 pid=184509)[0;0m INFO 09-11 17:22:31 [kv_cache_utils.py:854] Maximum concurrency for 4,096 tokens per request: 3246.50x
[1;36m(EngineCore_0 pid=184509)[0;0m INFO 09-11 17:22:31 [kv_cache_utils.py:850] GPU KV cache size: 1,669,376 tokens
[1;36m(EngineCore_0 pid=184509)[0;0m INFO 09-11 17:22:31 [kv_cache_utils.py:854] Maximum concurrency for 4,096 tokens per request: 3260.50x
[1;36m(EngineCore_0 pid=184509)[0;0m INFO 09-11 17:22:31 [kv_cache_utils.py:850] GPU KV cache size: 1,662,080 tokens
[1;36m(EngineCore_0 pid=184509)[0;0m INFO 09-11 17:22:31 [kv_cache_utils.py:854] Maximum concurrency for 4,096 tokens per request: 3246.25x
[1;36m(EngineCore_0 pid=184509)[0;0m INFO 09-11 17:22:31 [kv_cache_utils.py:850] GPU KV cache size: 1,669,376 tokens
[1;36m(EngineCore_0 pid=184509)[0;0m INFO 09-11 17:22:31 [kv_cache_utils.py:854] Maximum concurrency for 4,096 tokens per request: 3260.50x
[1;36m(EngineCore_0 pid=184509)[0;0m INFO 09-11 17:22:31 [kv_cache_utils.py:850] GPU KV cache size: 1,661,824 tokens
[1;36m(EngineCore_0 pid=184509)[0;0m INFO 09-11 17:22:31 [kv_cache_utils.py:854] Maximum concurrency for 4,096 tokens per request: 3245.75x
[1;36m(EngineCore_0 pid=184509)[0;0m INFO 09-11 17:22:31 [kv_cache_utils.py:850] GPU KV cache size: 1,669,760 tokens
[1;36m(EngineCore_0 pid=184509)[0;0m INFO 09-11 17:22:31 [kv_cache_utils.py:854] Maximum concurrency for 4,096 tokens per request: 3261.25x
[1;36m(EngineCore_0 pid=184509)[0;0m INFO 09-11 17:22:31 [core.py:217] init engine (profile, create kv cache, warmup model) took 4.65 seconds
[1;36m(EngineCore_0 pid=184509)[0;0m WARNING 09-11 17:22:31 [core.py:110] Using configured V1 scheduler class vllm_ascend.core.scheduler.AscendScheduler. This scheduler interface is not public and compatibility may not be maintained.
[1;36m(EngineCore_0 pid=184509)[0;0m INFO 09-11 17:22:31 [platform.py:144] Compilation disabled, using eager mode by default
[1;36m(EngineCore_0 pid=184509)[0;0m WARNING 09-11 17:22:31 [platform.py:162] compilation_config.level = CompilationLevel.NO_COMPILATION is set, Setting CUDAGraphMode to NONE
INFO 09-11 17:22:31 [llm.py:285] Supported_tasks: ['generate']
INFO 09-11 17:22:31 [__init__.py:36] No IOProcessor plugins requested by the model
[1;36m(EngineCore_0 pid=184509)[0;0m INFO 09-11 17:22:32 [scheduler.py:179] ======> [SCH-PREFILL] req=0 chunk step_tokens=1024 cp=4 sp=2 num_blocks_of_cp_sp.shape=(4, 2) token_budget_left=1024
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1155] **** number of scheduled tokens: 1024****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1155] **** number of scheduled tokens: 1024****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1155] **** number of scheduled tokens: 1024****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1155] **** number of scheduled tokens: 1024****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1155] **** number of scheduled tokens: 1024****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1155] **** number of scheduled tokens: 1024****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1190] =====> [MR-PREFILL-CP] req=0 sched_tokens=1024 cum_before=0 pos_cp.len=256 cp_pad_sched=1024
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1155] **** number of scheduled tokens: 1024****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1155] **** number of scheduled tokens: 1024****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1190] =====> [MR-PREFILL-CP] req=0 sched_tokens=1024 cum_before=0 pos_cp.len=256 cp_pad_sched=1024
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1190] =====> [MR-PREFILL-CP] req=0 sched_tokens=1024 cum_before=0 pos_cp.len=256 cp_pad_sched=1024
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1190] =====> [MR-PREFILL-CP] req=0 sched_tokens=1024 cum_before=0 pos_cp.len=256 cp_pad_sched=1024
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1190] =====> [MR-PREFILL-CP] req=0 sched_tokens=1024 cum_before=0 pos_cp.len=256 cp_pad_sched=1024
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1190] =====> [MR-PREFILL-CP] req=0 sched_tokens=1024 cum_before=0 pos_cp.len=256 cp_pad_sched=1024
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1190] =====> [MR-PREFILL-CP] req=0 sched_tokens=1024 cum_before=0 pos_cp.len=256 cp_pad_sched=1024
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1190] =====> [MR-PREFILL-CP] req=0 sched_tokens=1024 cum_before=0 pos_cp.len=256 cp_pad_sched=1024
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1296] =====> [MR-SLOT] PREFILL-CP slot_mapping.shape=(10240,) per_req_cp_pad_sched=[1024]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1296] =====> [MR-SLOT] PREFILL-CP slot_mapping.shape=(10240,) per_req_cp_pad_sched=[1024]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1296] =====> [MR-SLOT] PREFILL-CP slot_mapping.shape=(10240,) per_req_cp_pad_sched=[1024]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1296] =====> [MR-SLOT] PREFILL-CP slot_mapping.shape=(10240,) per_req_cp_pad_sched=[1024]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1296] =====> [MR-SLOT] PREFILL-CP slot_mapping.shape=(10240,) per_req_cp_pad_sched=[1024]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1296] =====> [MR-SLOT] PREFILL-CP slot_mapping.shape=(10240,) per_req_cp_pad_sched=[1024]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1296] =====> [MR-SLOT] PREFILL-CP slot_mapping.shape=(10240,) per_req_cp_pad_sched=[1024]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1296] =====> [MR-SLOT] PREFILL-CP slot_mapping.shape=(10240,) per_req_cp_pad_sched=[1024]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1417] =====> [MR-LONG] chunk_seqlens.len=1 q_head_idx.len=128 q_tail_idx.len=128 attn_mask_seqlens.shape=torch.Size([2, 1]) head_nomask_seqlens.shape=torch.Size([2, 1]) tail_nomask_seqlens.shape=torch.Size([2, 1]) cp_mask.shape=torch.Size([512, 512])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1417] =====> [MR-LONG] chunk_seqlens.len=1 q_head_idx.len=128 q_tail_idx.len=128 attn_mask_seqlens.shape=torch.Size([2, 1]) head_nomask_seqlens.shape=torch.Size([2, 1]) tail_nomask_seqlens.shape=torch.Size([2, 1]) cp_mask.shape=torch.Size([512, 512])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1417] =====> [MR-LONG] chunk_seqlens.len=1 q_head_idx.len=128 q_tail_idx.len=128 attn_mask_seqlens.shape=torch.Size([2, 1]) head_nomask_seqlens.shape=torch.Size([2, 1]) tail_nomask_seqlens.shape=torch.Size([2, 1]) cp_mask.shape=torch.Size([512, 512])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1417] =====> [MR-LONG] chunk_seqlens.len=1 q_head_idx.len=128 q_tail_idx.len=128 attn_mask_seqlens.shape=torch.Size([2, 1]) head_nomask_seqlens.shape=torch.Size([2, 1]) tail_nomask_seqlens.shape=torch.Size([2, 1]) cp_mask.shape=torch.Size([512, 512])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1417] =====> [MR-LONG] chunk_seqlens.len=1 q_head_idx.len=128 q_tail_idx.len=128 attn_mask_seqlens.shape=torch.Size([2, 1]) head_nomask_seqlens.shape=torch.Size([2, 1]) tail_nomask_seqlens.shape=torch.Size([2, 1]) cp_mask.shape=torch.Size([512, 512])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1417] =====> [MR-LONG] chunk_seqlens.len=1 q_head_idx.len=128 q_tail_idx.len=128 attn_mask_seqlens.shape=torch.Size([2, 1]) head_nomask_seqlens.shape=torch.Size([2, 1]) tail_nomask_seqlens.shape=torch.Size([2, 1]) cp_mask.shape=torch.Size([512, 512])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1417] =====> [MR-LONG] chunk_seqlens.len=1 q_head_idx.len=128 q_tail_idx.len=128 attn_mask_seqlens.shape=torch.Size([2, 1]) head_nomask_seqlens.shape=torch.Size([2, 1]) tail_nomask_seqlens.shape=torch.Size([2, 1]) cp_mask.shape=torch.Size([512, 512])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1417] =====> [MR-LONG] chunk_seqlens.len=1 q_head_idx.len=128 q_tail_idx.len=128 attn_mask_seqlens.shape=torch.Size([2, 1]) head_nomask_seqlens.shape=torch.Size([2, 1]) tail_nomask_seqlens.shape=torch.Size([2, 1]) cp_mask.shape=torch.Size([512, 512])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m WARNING 09-11 17:22:32 [cudagraph_dispatcher.py:102] cudagraph dispatching keys are not initialized. No cudagraph will be used.
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m WARNING 09-11 17:22:32 [cudagraph_dispatcher.py:102] cudagraph dispatching keys are not initialized. No cudagraph will be used.
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m WARNING 09-11 17:22:32 [cudagraph_dispatcher.py:102] cudagraph dispatching keys are not initialized. No cudagraph will be used.
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m WARNING 09-11 17:22:32 [cudagraph_dispatcher.py:102] cudagraph dispatching keys are not initialized. No cudagraph will be used.
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m WARNING 09-11 17:22:32 [cudagraph_dispatcher.py:102] cudagraph dispatching keys are not initialized. No cudagraph will be used.
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m WARNING 09-11 17:22:32 [cudagraph_dispatcher.py:102] cudagraph dispatching keys are not initialized. No cudagraph will be used.
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m WARNING 09-11 17:22:32 [cudagraph_dispatcher.py:102] cudagraph dispatching keys are not initialized. No cudagraph will be used.
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m WARNING 09-11 17:22:32 [cudagraph_dispatcher.py:102] cudagraph dispatching keys are not initialized. No cudagraph will be used.
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer0_cp1_sp0_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer0_cp1_sp0_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer0_cp3_sp0_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer0_cp2_sp0_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer0_cp0_sp0_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer0_cp3_sp0_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer0_cp2_sp0_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer0_cp0_sp0_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer0_cp2_sp1_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer0_cp1_sp1_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer0_cp0_sp1_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer0_cp2_sp1_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer0_cp1_sp1_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer0_cp0_sp1_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer0_cp3_sp1_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer0_cp3_sp1_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer1_cp0_sp0_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer1_cp1_sp0_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer1_cp2_sp1_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer1_cp1_sp1_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer1_cp3_sp0_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer1_cp2_sp0_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer1_cp0_sp1_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer1_cp3_sp1_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer1_cp0_sp0_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer1_cp1_sp0_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer1_cp1_sp1_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer1_cp3_sp0_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer1_cp2_sp1_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer1_cp2_sp0_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer1_cp0_sp1_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer1_cp3_sp1_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer2_cp0_sp0_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer2_cp1_sp0_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer2_cp3_sp0_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer2_cp1_sp1_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer2_cp2_sp0_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer2_cp2_sp1_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer2_cp3_sp1_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer2_cp0_sp1_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer2_cp0_sp0_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer2_cp1_sp0_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer2_cp3_sp0_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer2_cp1_sp1_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer2_cp2_sp0_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer2_cp2_sp1_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer2_cp3_sp1_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer2_cp0_sp1_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer24_cp1_sp1_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer24_cp2_sp1_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer24_cp0_sp1_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer24_cp1_sp0_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer24_cp3_sp1_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer24_cp0_sp0_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer24_cp3_sp0_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer24_cp2_sp0_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer24_cp0_sp0_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer24_cp0_sp1_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer24_cp1_sp0_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer24_cp1_sp1_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer24_cp2_sp1_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer24_cp3_sp1_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer24_cp3_sp0_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer24_cp2_sp0_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer25_cp0_sp0_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer25_cp2_sp1_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer25_cp3_sp1_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer25_cp1_sp0_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer25_cp0_sp1_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer25_cp1_sp1_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer25_cp3_sp0_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer25_cp2_sp0_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer25_cp0_sp0_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer25_cp0_sp1_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer25_cp1_sp0_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer25_cp3_sp1_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer25_cp2_sp1_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer25_cp1_sp1_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer25_cp3_sp0_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer25_cp2_sp0_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([1024, 1, 512]), k_pe shape:torch.Size([1024, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer26_cp0_sp0_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer26_cp0_sp1_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer26_cp1_sp0_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer26_cp3_sp1_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer26_cp3_sp0_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer26_cp2_sp1_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer26_cp2_sp0_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer26_cp1_sp1_step0_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([128]) q_tail_idx.shape=torch.Size([128]) out_head.shape=torch.Size([128, 8, 128]) out_tail.shape=torch.Size([128, 8, 128]) out_concat.shape=torch.Size([256, 8, 128]) lse_head.shape=torch.Size([8, 128]) lse_tail.shape=torch.Size([8, 128])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer26_cp0_sp0_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer26_cp0_sp1_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer26_cp3_sp1_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer26_cp3_sp0_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer26_cp2_sp0_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer26_cp2_sp1_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer26_cp1_sp0_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer26_cp1_sp1_step0_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m INFO 09-11 17:22:32 [scheduler.py:370] ======> [SCH-RUNNING] req=0 chunk step_tokens=122 cp=4 sp=2 num_blocks_of_cp_sp.shape=(4, 2) token_budget_left=1024
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1155] **** number of scheduled tokens: 122****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1155] **** number of scheduled tokens: 122****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1155] **** number of scheduled tokens: 122****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1155] **** number of scheduled tokens: 122****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1155] **** number of scheduled tokens: 122****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1155] **** number of scheduled tokens: 122****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1155] **** number of scheduled tokens: 122****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1155] **** number of scheduled tokens: 122****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1190] =====> [MR-PREFILL-CP] req=0 sched_tokens=122 cum_before=1024 pos_cp.len=32 cp_pad_sched=128
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1190] =====> [MR-PREFILL-CP] req=0 sched_tokens=122 cum_before=1024 pos_cp.len=32 cp_pad_sched=128
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1190] =====> [MR-PREFILL-CP] req=0 sched_tokens=122 cum_before=1024 pos_cp.len=32 cp_pad_sched=128
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1190] =====> [MR-PREFILL-CP] req=0 sched_tokens=122 cum_before=1024 pos_cp.len=32 cp_pad_sched=128
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1190] =====> [MR-PREFILL-CP] req=0 sched_tokens=122 cum_before=1024 pos_cp.len=32 cp_pad_sched=128
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1190] =====> [MR-PREFILL-CP] req=0 sched_tokens=122 cum_before=1024 pos_cp.len=32 cp_pad_sched=128
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1190] =====> [MR-PREFILL-CP] req=0 sched_tokens=122 cum_before=1024 pos_cp.len=32 cp_pad_sched=128
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1190] =====> [MR-PREFILL-CP] req=0 sched_tokens=122 cum_before=1024 pos_cp.len=32 cp_pad_sched=128
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1296] =====> [MR-SLOT] PREFILL-CP slot_mapping.shape=(10240,) per_req_cp_pad_sched=[128]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1296] =====> [MR-SLOT] PREFILL-CP slot_mapping.shape=(10240,) per_req_cp_pad_sched=[128]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1296] =====> [MR-SLOT] PREFILL-CP slot_mapping.shape=(10240,) per_req_cp_pad_sched=[128]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1296] =====> [MR-SLOT] PREFILL-CP slot_mapping.shape=(10240,) per_req_cp_pad_sched=[128]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1296] =====> [MR-SLOT] PREFILL-CP slot_mapping.shape=(10240,) per_req_cp_pad_sched=[128]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1296] =====> [MR-SLOT] PREFILL-CP slot_mapping.shape=(10240,) per_req_cp_pad_sched=[128]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1296] =====> [MR-SLOT] PREFILL-CP slot_mapping.shape=(10240,) per_req_cp_pad_sched=[128]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1296] =====> [MR-SLOT] PREFILL-CP slot_mapping.shape=(10240,) per_req_cp_pad_sched=[128]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1417] =====> [MR-LONG] chunk_seqlens.len=1 q_head_idx.len=16 q_tail_idx.len=16 attn_mask_seqlens.shape=torch.Size([2, 1]) head_nomask_seqlens.shape=torch.Size([2, 1]) tail_nomask_seqlens.shape=torch.Size([2, 1]) cp_mask.shape=torch.Size([512, 512])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1417] =====> [MR-LONG] chunk_seqlens.len=1 q_head_idx.len=16 q_tail_idx.len=16 attn_mask_seqlens.shape=torch.Size([2, 1]) head_nomask_seqlens.shape=torch.Size([2, 1]) tail_nomask_seqlens.shape=torch.Size([2, 1]) cp_mask.shape=torch.Size([512, 512])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1417] =====> [MR-LONG] chunk_seqlens.len=1 q_head_idx.len=16 q_tail_idx.len=16 attn_mask_seqlens.shape=torch.Size([2, 1]) head_nomask_seqlens.shape=torch.Size([2, 1]) tail_nomask_seqlens.shape=torch.Size([2, 1]) cp_mask.shape=torch.Size([512, 512])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1417] =====> [MR-LONG] chunk_seqlens.len=1 q_head_idx.len=16 q_tail_idx.len=16 attn_mask_seqlens.shape=torch.Size([2, 1]) head_nomask_seqlens.shape=torch.Size([2, 1]) tail_nomask_seqlens.shape=torch.Size([2, 1]) cp_mask.shape=torch.Size([512, 512])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1417] =====> [MR-LONG] chunk_seqlens.len=1 q_head_idx.len=16 q_tail_idx.len=16 attn_mask_seqlens.shape=torch.Size([2, 1]) head_nomask_seqlens.shape=torch.Size([2, 1]) tail_nomask_seqlens.shape=torch.Size([2, 1]) cp_mask.shape=torch.Size([512, 512])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1417] =====> [MR-LONG] chunk_seqlens.len=1 q_head_idx.len=16 q_tail_idx.len=16 attn_mask_seqlens.shape=torch.Size([2, 1]) head_nomask_seqlens.shape=torch.Size([2, 1]) tail_nomask_seqlens.shape=torch.Size([2, 1]) cp_mask.shape=torch.Size([512, 512])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1417] =====> [MR-LONG] chunk_seqlens.len=1 q_head_idx.len=16 q_tail_idx.len=16 attn_mask_seqlens.shape=torch.Size([2, 1]) head_nomask_seqlens.shape=torch.Size([2, 1]) tail_nomask_seqlens.shape=torch.Size([2, 1]) cp_mask.shape=torch.Size([512, 512])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1417] =====> [MR-LONG] chunk_seqlens.len=1 q_head_idx.len=16 q_tail_idx.len=16 attn_mask_seqlens.shape=torch.Size([2, 1]) head_nomask_seqlens.shape=torch.Size([2, 1]) tail_nomask_seqlens.shape=torch.Size([2, 1]) cp_mask.shape=torch.Size([512, 512])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer0_cp0_sp0_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer0_cp1_sp0_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer0_cp3_sp0_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer0_cp2_sp0_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer0_cp0_sp1_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer0_cp1_sp1_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer0_cp2_sp1_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer0_cp3_sp1_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer0_cp0_sp0_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer0_cp1_sp0_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer0_cp3_sp0_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer0_cp0_sp1_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer0_cp2_sp0_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer0_cp1_sp1_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer0_cp2_sp1_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer0_cp3_sp1_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer1_cp3_sp0_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer1_cp0_sp0_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer1_cp1_sp0_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer1_cp2_sp0_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer1_cp1_sp1_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer1_cp0_sp1_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer1_cp3_sp1_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer1_cp2_sp1_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer1_cp0_sp0_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer1_cp1_sp0_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer1_cp3_sp0_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer1_cp2_sp0_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer1_cp0_sp1_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer1_cp1_sp1_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer1_cp3_sp1_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer1_cp2_sp1_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer2_cp0_sp0_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer2_cp3_sp0_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer2_cp2_sp0_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer2_cp1_sp0_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer2_cp0_sp1_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer2_cp1_sp1_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer2_cp3_sp1_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer2_cp2_sp1_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer2_cp0_sp0_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer2_cp3_sp0_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer2_cp0_sp1_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer2_cp1_sp0_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer2_cp2_sp0_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer2_cp1_sp1_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer2_cp3_sp1_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer2_cp2_sp1_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer24_cp0_sp0_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer24_cp1_sp0_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer24_cp0_sp1_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer24_cp3_sp0_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer24_cp3_sp1_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer24_cp2_sp0_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer24_cp1_sp1_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer24_cp2_sp1_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer24_cp0_sp0_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer24_cp1_sp0_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer24_cp0_sp1_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer24_cp3_sp0_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer24_cp3_sp1_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer24_cp2_sp0_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer24_cp1_sp1_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer24_cp2_sp1_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer25_cp0_sp0_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer25_cp1_sp0_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer25_cp3_sp1_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer25_cp0_sp1_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer25_cp3_sp0_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer25_cp2_sp0_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer25_cp1_sp1_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer25_cp2_sp1_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer25_cp0_sp0_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer25_cp1_sp0_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer25_cp0_sp1_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer25_cp3_sp1_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer25_cp3_sp0_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer25_cp2_sp0_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer25_cp1_sp1_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer25_cp2_sp1_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1437] [dump info], kv_c_normed shape:torch.Size([128, 1, 512]), k_pe shape:torch.Size([128, 1, 64])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer26_cp0_sp0_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer26_cp3_sp0_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer26_cp2_sp0_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer26_cp3_sp1_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer26_cp2_sp1_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer26_cp1_sp0_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer26_cp0_sp1_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer26_cp1_sp1_step1_kv_prefill.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer26_cp0_sp0_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:1049] #####> [MLA-PREFILL-CP] q_head_idx.shape=torch.Size([16]) q_tail_idx.shape=torch.Size([16]) out_head.shape=torch.Size([16, 8, 128]) out_tail.shape=torch.Size([16, 8, 128]) out_concat.shape=torch.Size([32, 8, 128]) lse_head.shape=torch.Size([8, 16]) lse_tail.shape=torch.Size([8, 16])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer26_cp3_sp1_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer26_cp2_sp0_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer26_cp3_sp0_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer26_cp0_sp1_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer26_cp1_sp0_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer26_cp2_sp1_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [mla_v1.py:642] [DUMP] wrote debug/compare/layer26_cp1_sp1_step1_attn_prefill_out.pkl
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:32 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1155] **** number of scheduled tokens: 1****
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184536)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184541)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184516)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1288] =====> [MR-PREFILL] cp=4 sp=2 num_reqs=1 query_lens.shape=torch.Size([1]) seq_lens.shape=torch.Size([1])
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184551)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184531)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184546)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP0 pid=184526)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
[1;36m(EngineCore_0 pid=184509)[0;0m [1;36m(VllmWorker TP1 pid=184521)[0;0m INFO 09-11 17:22:33 [model_runner_v1.py:1302] =====> [MR-SLOT] DECODE-CP slot_mapping.shape=(10240,) per_req_sched=[1]
TTFT: 2175.3756999969482 ms
req_num: 0
[['593', '595', '597', '599', '']] -> Generated text: '6000000000'
Token ids: [21, 15, 15, 15, 15, 15, 15, 15, 15, 15]

end.
ERROR 09-11 17:22:36 [core_client.py:562] Engine core proc EngineCore_0 died unexpectedly, shutting down client.
